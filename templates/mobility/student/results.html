{% extends "layouts/base_dashboard.html" %}
{% block title %}Resultats{% endblock %}
{% block topbar_subtitle %}Espace Etudiant{% endblock %}
{% block sidebar_content %}
  {% include "layouts/sidebar_student.html" %}
{% endblock %}
{% block sidebar_mobile %}
  {% include "layouts/sidebar_student.html" %}
{% endblock %}
{% block content %}
<div class="student-hero">
  <div>
    <h1>Resultats</h1>
    <p>Selection, affectation et decision finale</p>
  </div>
</div>

<div class="row g-3">
  <div class="col-lg-6">
    <div class="student-card h-100">
      <div class="student-card-header">
        <h2>Selection</h2>
      </div>
      {% if student.selection_result %}
        <div class="d-flex flex-column gap-2">
          <div><span class="text-muted small">Note</span><div class="fw-semibold">{{ student.selection_result.note_selection }}</div></div>
          <div><span class="text-muted small">Rang</span><div class="fw-semibold">{{ student.selection_result.rang }}</div></div>
          <div><span class="text-muted small">Liste attente</span><div class="fw-semibold">{{ student.selection_result.passe_attente }}</div></div>
        </div>
      {% else %}
        <div class="text-muted">Pas de resultat de selection pour le moment.</div>
      {% endif %}
    </div>
  </div>

  <div class="col-lg-6">
    <div class="student-card h-100">
      <div class="student-card-header">
        <h2>Affectation</h2>
      </div>
      {% if student.affectation %}
        <div class="d-flex flex-column gap-2">
          <div><span class="text-muted small">Partenaire</span><div class="fw-semibold">{{ student.affectation.place.partenaire.nom }}</div></div>
          <div><span class="text-muted small">Type</span><div class="fw-semibold">{{ student.affectation.place.type_mobilite }}</div></div>
          <div><span class="text-muted small">Statut</span><div class="fw-semibold">{{ student.affectation.statut }}</div></div>
        </div>
        {% if partner_decision %}
          <div class="mt-3">
            <span class="badge text-bg-secondary">Decision partenaire: {{ partner_decision.resultat }}</span>
            {% if partner_decision.lettre_reponse %}
              <div class="mt-2"><a href="{{ partner_decision.lettre_reponse.url }}" target="_blank">Telecharger la lettre</a></div>
            {% endif %}
          </div>
        {% elif student.affectation.lettre_reponse %}
          <div class="mt-3">
            <a href="{{ student.affectation.lettre_reponse.url }}" target="_blank">Telecharger la lettre</a>
          </div>
        {% endif %}
      {% else %}
        <div class="text-muted">Aucune affectation.</div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
